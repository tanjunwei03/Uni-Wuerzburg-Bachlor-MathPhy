\begin{Problem}
	Betrachten Sie eine obere Dreiecksmatrix $A\in \R^{n\times n}$ mit den Zahlen $d_1,\dots d_n\in \R$ auf der Diagonalen.
	\begin{parts}
		\item Zeigen Sie, dass $A$ genau dann invertierbar ist, wenn $D:= d_1\dots d_n\neq 0$ gilt. Beweisen Sie, dass in diesem Fall die zu $A$ inverse Matrix ebenfalls eine obere Dreiecksmatrix ist.
		\item  Seien nun alle Einträge von $A$ ganze Zahlen und $A$ invertierbar. Zeigen Sie, dass die inverse Matrix $A^{-1}$ aus rationalen Einträgen besteht, wobei (im gekürzten Fall) als Nenner höchstens $D$ auftritt.
	\end{parts}
\end{Problem}
\begin{proof}
	\begin{parts}
	\item Es genügt zu zeigen, dass $\text{det}(A)=d_1\dots d_n$ f\"{u}r ein Dreiecksmatrix gilt. Wir beweisen es per Induktion auf $n$. F\"{u}r $n=1$ ist $\text{det}(A_1)=A_{11}$. Wir nehmen an, dass die Behauptung f\"{u}r $n-1$ gilt, wobei $n\in \N$ beliebig ist. Wir betrachten ein $n\times n$ Dreiecksmatrix $A_n$ und ein Laplaceentwicklung auf der ersten Spalte.
		\begin{center}
		\begin{tikzpicture}
				\matrix (M)[matrix of math nodes, row sep = 0.5cm, column sep = 0.5cm,left delimiter={(},right delimiter={)}]{
					a_{11} & a_{12} & a_{13} & \dots & a_{1n}\\
					0 & a_{22} & a_{23} & \dots & a_{2n}\\
					0 & 0 & a_{33} & \dots & a_{3n}\\
					\vdots & \vdots & \vdots & \ddots & \vdots\\
					0 & 0 & 0 & \dots & a_{nn}\\
				};
				\draw[thick, blue] (-2.6,2.5) -- (-2.6,-2.5);
				\draw[thick, blue] (-1.7,-2.5) rectangle (3,1.6);
				\draw (0.5,-0.5) node[blue] {$A_{n-1}$};
			\end{tikzpicture}
		\end{center}
		Also $\text{det}(A_n)=a_{11}\text{det}(A_{n-1})$. Als Induktionsannahme haben wir angenommen, dass $\text{det}(A_{n-1})=a_{22}a_{33}\dots a_{nn}$. Daraus folgt:
		\[
			\text{det}(A_n)=a_{11}a_{22}\dots a_{nn}
		.\] 
		Die Ergebnis folgt daraus und aus Proposition 6.28.
	\item Wir beweisen es durch Durchfürung des Gauß-Algorithismus.

		Wir fangen an mit dem zweiten Spalte bzw. zweiten Zeile. Wir dividieren das zweite Zeile durch $a_{22}$. Das Matrix sieht so aus
		\[
			\left( 
				\begin{array}{ccccc|ccccc}
					a_{11} & a_{12} & a_{13} & \dots & a_{1n} & 1 & 0 & 0 & \dots & 0\\
					0 & 1 & a_{23} / a_{22} & \dots & a_{2n} / a_{22} & 0 & 1 / a_{22} & 0 & \dots & 0\\
					0 & 0 & a_{33} & \dots & a_{3n} & 0 & 0 & 1 & \dots & 0\\
					\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
					0 & 0 & 0 & \dots & a_{nn} & 0 & 0 & 0 & \dots & 1
				\end{array}
			\right)  
		.\] 
		Dann subtrahtieren wir $a_{12}$ mal die zweite Zeile von die erste Zeile. Weil der Einträg in der linken Seite der zweiten Zeile eine rationale Zahl mit Nenner höchstens $a_{22}$ ist, werden alle Einträge in der zweiten Spalte des ehemaligen Einheitsmatrix auch rationale Zahlen mit Nenner höchstens $\frac{1}{a_{22}}$.

		Danach dividieren wir die dritte Zeile durch $a_{22}a_{33}$. Dann sieht das Matrix so aus
			\[
		\left( 
		\begin{array}{ccccc|ccccc}
			a_{11} & 0 & a_{13} & \dots & a_{1n} & 1 & -1/a_{22} & 0 & \dots & 0\\
			0 & 1 & a_{23} / a_{22} & \dots & a_{2n} / a_{22} & 0 & 1 / a_{22} & 0 & \dots & 0\\
			0 & 0 & 1/a_{22} & \dots & 1 & 0 & 0 & 1/(a_{22}a_{33}) & \dots & 0\\
			\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\
			0 & 0 & 0 & \dots & a_{nn} & 0 & 0 & 0 & \dots & 1
		\end{array}
		\right)  
		.\] 
		Alle Einträge in der dritten Spalte sind Vielfachen von $1/a_{22}$, also wir können alle Einträge darin $0$ machen durch subtrahtieren ein Vielfaches von die dritte Zeile, was das Nenner nicht erhöhen kann. 
		
		Ähnlich machen wir weiter. Wir dividieren die vierte Zeile durch $1/a_{22}a_{33}a_{44}$. Alle Einträge in die vierte Spalte werden nur Vielfachen von $1/a_{22}a_{33}$. Zuletzt dividieren wir die erste Zeile durch $a_{11}$, damit das Matrix auf der linken Seite das Einheitsmatrix ist. Dann kann das Nenner höchstens $a_{11}\dots a_{nn}$ sein.\qedhere
	\end{parts}
\end{proof}
\begin{Problem}
	Es sei im Folgenden $\mathbb{K}=\R$ oder $\mathbb{K}=\C$. Wir definieren die Spur
	\[
		\text{tr}:M_n(\mathbb{K})\to \mathbb{K}, \qquad A \to \sum_{i=1}^n (A)_{ii}
	.\] 
	Zeigen Sie:
	\begin{parts}
	\item Die Spur ist ein lineares Funktional in $M_n(\mathbb{K})^*$.
	\item F\"{u}r $A,B\in M_n(\mathbb{K})$ gilt
		\[ 
			\text{tr}(AB)=\text{tr}(BA)
		.\] 
	\item F\"{u}r $A\in GL_n(\mathbb{K})$ und $B\in M_n(\mathbb{K})$ gilt
		\[
			\text{tr}(ABA^{-1})=\text{tr}(B)
		.\] 
	\item Ist $f\in M_N(\mathbb{K})^*$ ein lineares Funktional mit
		\[
		f(AB)=f(BA),\qquad f(1)=n\] 
		f\"{u}r $A,B\in M_n(\mathbb{K})$, dann gilt bereits $f=\text{tr}$.
	\end{parts}
\end{Problem}
\begin{proof}
	\begin{parts}
	\item Sei $x,y\in \R$ und $A,B\in M_n(\mathbb{K})$. Es gilt
		\begin{align*}
			\text{tr}(xA+yB)=&\sum_{i=1}^n\left( xA+yB \right)_{ii}\\
			=& \sum_{i=1}^n \left[ (xA)_{ii}+(yB)_{ii} \right] \\
			=&\sum_{i=1}^n \left( xA \right)_{ii}+\sum_{i=1}^n \left( yB \right)_{ii}\\
			=& x\sum_{i=1}^n (A)_{ii}+y\sum_{i=1}^n (B)_{ii}\\
			=&x\text{tr}(A)+y\text{tr}(B).
		\end{align*}
	\item Es gilt
		\[
			(AB)_{ij}=\sum_{k=1}^n A_{ik}B_{kj}
		.\] 
		Dann ist
		\begin{align*}
			\sum_{i=1}^n (AB)_{ii}=&\sum_{i=1}^n\sum_{k=1}^n A_{ik}B_{ki}\\
			=&\sum_{k=1}^n\sum_{i=1}^n A_{ik}B_{ki} & \text{wir dürfen endliche Summe umordnen}\\
			=&\sum_{i=1}^n\sum_{k=1}^n A_{ki}B_{ik} & \text{wir vertauschen }i\text{ und }k\\
			=&\sum_{i=1}^n\sum_{k=1}^n B_{ik}A_{ki} & \mathbb{K}\text{ ist kommutativ}\\
			=&\text{tr}(BA)
		\end{align*}
	\item Es gilt
		\begin{align*}
			\text{tr}(ABA^{-1})=&\text{tr}\left( (AB)A^{-1} \right) \\
			=&\text{tr}\left( A^{-1}(AB) \right) \\
			=& \text{tr}(A^{-1}AB)\\
			=&\text{tr}(AB)
		\end{align*}
	\item Wir betrachten ein Basis f\"{u}r $M_n(\mathbb{K})$. Das gewählte Basis ist die Elementarmatrizen $E_{ij}$ (s. Proposition 5.54). Es gilt
		\[
			E_{ii}E_{ij}=E_{ij}\qquad E_{ij}E_{ii}=0\qquad i\neq j
		.\] 
		Es folgt $f(E_{ij})=f(E_{ii}E_{ij})=f(E_{ij}E_{ii})=f(0)=0$, also $f(M)$ ist nicht von nichtdiagonale Elemente abhängig. 

		Danach betrachten wir die diagonale Elemente. Wir können ein Permutationsmatrix (ein Matrix mit die Zeilen $i$ und $j$ vertauscht) $P$ betrachten. Es gilt $P^{-1}=P$ und
	\[
		P^{-1}\text{diag}(\lambda_1,\dots,\lambda_i,\dots,\lambda_j,\dots,\lambda_n)P=\text{diag}(\lambda_1,\dots,\lambda_j,\dots,\lambda_i,\dots,\lambda_n)
	.\] 
	Weil $f$ angewandt auf die beide Seite der Gleichung wegen (c) gleich sein muss, ist $f$ unabhängig von ein Umordnung der diagonale Elemente. Zuletzt gilt
	\[
		f(1)=\sum_{i=1}^n f(E_{ii})=nf(E_{11})=n
	,\] 
	also
	\[
		f(E_{ii})=1\qquad\text{f\"{u}r alle }i
	.\] 
	Dann ist $f=\text{tr}$.\qedhere
	\end{parts}
\end{proof}
\begin{Problem}
	Bestimmen Sie zu den folgenden linearen Abbildungen jeweils alle Eigenwerte und Eigenräume. Entscheiden Sie weiterhin, ob die entsprechende Abbildung diagonalisierbar ist.
	\begin{parts}
	\item 
		\[
		T:\R^n\to \R^n,\qquad x\to Ax,\] mit
		\[
			A=\begin{pmatrix} -1 & 0 & 1 \\ 1 & -1 & 0 \\ -4 & 2 & 2 \end{pmatrix} 
		.\] 
	\item 
		\[
		T:\C^n\to \C^n\qquad x\to Ax,\] mit $A$ wie in (a).
	\item 
		\[
			T:M_n(\mathbb{K})\to M_N(\mathbb{K}),\qquad A\to \text{tr}(A)1
		.\] 
	\item
		 \[
			 T: M_n(\mathbb{K})\to M_n(\mathbb{K}),\qquad A\to A^T
		.\] 
	\end{parts}
\end{Problem}

\begin{proof}
	\begin{parts}
	\item 
		\begin{align*}
			\text{det}(A-\lambda I)=&\text{det}\begin{pmatrix} -1-\lambda & 0 & 1 \\ 1 & -1-\lambda & 0 \\ -4 & 2 & 2-\lambda \end{pmatrix} \\
			=&(-1-\lambda)(-(1+\lambda)(2-\lambda)-0)+(2-(1+\lambda)(4))\\
			=&-\lambda-\lambda^3\\
			=&-\lambda(1+\lambda^2)
		\end{align*}
		also $\lambda=0$ ist ein Eigenwert, aber $1+\lambda^2=0$ hat keine Lösung in $\R$, also es gibt nur ein Eigenwert, also $T$ ist nicht diagonaliserbar.
	\item Das charakteristische Polynom hat $3$ unterschiedliche Eigenwerte, $\lambda=0$ und $\lambda=\pm 1$. Weil alle Eigenwerte unterschiedlich sind und der Eigenraum mindestens Dimension $1$ hat, ist es diagonalisierbar. 
	\item Sei $A\in M_n(\mathbb{K})$. $A$ ist ein Eigenvektor von $T$ genau dann, wenn
		\[
			A=\lambda\text{tr}(A)1_n
		.\] 
		Also gilt, dass $A$ diagonal ist und
		\[
			n\text{tr}(A)=\lambda\text{tr}(A)
	\]
	also es gibt nur ein Eigenwert $n$ und der Eigenraum ist gespannte durch
	\[
		\text{span}\left( 1_n \right) 
	,\] 
	was ein $1$-dimensionaler Vektorraum ist. F\"{u}r $n>1$ kann es kein Basis sein, und $T$ ist nicht diagonaliserbar. F\"{u}r $n=1$ ist $T$ das Identität, also es ist schon diagonal.
\item Sei $A\in M_n(\mathbb{K})$. $A$ ist ein Eigenvektor genau dann, wenn
	\[
	A^T=\lambda A
	.\] 
	Wir können hier sofort zwei Eigenwerte und deren Eigenräume lesen:
	\begin{align*}
		\lambda=1:& A\in \text{SM}_n(\mathbb{K})\\
		\lambda=-1:&A\in \text{AS}_n(\mathbb{K})
	\end{align*}
	Das Dimension der Eigenraum wissen wir schon
	\begin{align*}
		\text{dim}\left( \text{SM}_n(\mathbb{K}) \right) =&\frac{n(n+1)}{2}\\
		\text{dim}(\text{AS}_n(\mathbb{K}))=&\frac{n(n-1)}{2}
	\end{align*}
	Es gilt
	\[
		\frac{n(n+1)}{2}+\frac{n(n-1)}{2}=n^2
	,\]
	also wir können ein Basis für $M_n(\mathbb{K})$ finden mit genau $\frac{n(n+1)}{2}$ Vektoren aus $\lambda=1$ Eigenraum und $\frac{n(n-1)}{2}$ Vektoren aus dem $\lambda=-1$ Eigenraum. Daraus folgt: $T$ ist diagonaliserbar.\qedhere
	\end{parts}
\end{proof}
\begin{Problem}
	Über einen algebraisch vollständigen Körper $\mathbb{K}$ zerfällt das charakteristische Polynom $\chi_A (x)$ einer Matrix $A\in M_n(\mathbb{K})$ immer in Linearfaktoren
	\[
		\chi_A(x):=\text{det}(A-x 1)=(\lambda_1-x)^{\mu_1}\cdot\dots\cdot(\lambda_m-x)^{\mu_m}
	.\] 
	Dabei ist der Exponent $\mu_i$ die algebraische Vielfachheit zum Eigenwert $\lambda_i$ und $n=\mu_1+\dots+\mu_m$. Es sei $V_{\lambda_i}$ der Eigenraum zum Eigenwert $\lambda_i$, dann bezeichnen wir die Dimension des Eigenraums
	\[
		d_i:=\text{dim}(V_{\lambda_i})\] als geometrische Vielfachheit von $\lambda_i$. Zeigen Sie: Es gilt immer
		\[
		\mu_i\ge d_i,\qquad\forall i=1,\dots,m
		.\] 
		{\footnotesize\emph{Hinweis: Führen Sie einen Basiswechsel mit einer möglichst geschickt gewählten Basis B durch.}} 
\end{Problem}
\begin{proof}
	Sei $\lambda_i$ ein Eigenwert mit geometrische Vielfachheit $d_i$. Das heißt, dass wir $d_i$ linear unabhängige Vektoren finden können, so dass $Av=\lambda_i v$ f\"{u}r alle solche Vektoren. Dann ergänzen wir die Basis, so dass die erste $d_i$ Vektoren in der Basis Eigenvektoren mit Eigenwert $\lambda_i$ sind. Das charakteristische Polynom verändert sich nicht, wenn wir ein Basiswechsel machen. Also das charakterische Polynom ist gleich das charakteristische Polynom von
	\[
		A'=\begin{pmatrix} \lambda 1_{d_i} & B \\ 0 & C \end{pmatrix} 
	.\] 
	Es gilt
	\[
		\text{det}(A'-x 1_n)=(x-\lambda)^{d_i}\text{det}(C) 
	,\]
	also die algebraische Vielfachheit von $\lambda_i$ ist mindestens die geometrische Vielfachheit.
\end{proof}
